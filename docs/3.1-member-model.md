# Member Model

## Quick Navigation

- [Overview](1-overview.md)
- [System Architecture](2-system-architecture.md)
  - [Application Configuration](2.1-application-configuration.md)
- [Database Models](3-database-models.md)
  - [Member Model](3.1-member-model.md)
  - [Attendance Model](3.2-attendance-model.md)
  - [Streak Model](3.3-streak-model.md)
  - [Project Model](3.4-project-model.md)
- [GraphQL API](4-graphql-api.md)
  - [GraphQL Queries](4.1-graphql-queries.md)
    - [Member Queries](4.1.1-member-queries.md)
    - [Attendance Queries](4.1.2-attendance-queries.md)
    - [Streak Queries](4.1.3-streak-queries.md)
    - [Project Queries](4.1.4-project-queries.md)
  - [GraphQL Mutations](4.2-graphql-mutations.md)
    - [Member Mutations](4.2.1-member-mutations.md)
    - [Attendance Mutations](4.2.2-attendance-mutations.md)
    - [Streak Mutations](4.2.3-streak-mutations.md)
    - [Project Mutations](4.2.4-project-mutations.md)
- [Background Tasks](5-background-tasks.md)
  - [Daily Attendance Task](5.1-daily-attendance-task.md)
- [Deployment and CI/CD](6-deployment-and-cicd.md)
  - [GitHub Actions Workflows](6.1-github-actions-workflows.md)
  - [Docker Deployment](6.2-docker-deployment.md)
- [Security Features](7-security-features.md)
  - [HMAC Authentication](7.1-hmac-authentication.md)

## Table of Contents

- [Member Model](#member-model)
  - [Purpose and Scope](#purpose-and-scope)
  - [Model Overview](#model-overview)
  - [Field Definitions](#field-definitions)
  - [Sex Enumeration](#sex-enumeration)
  - [Related Models and Relationships](#related-models-and-relationships)
  - [GraphQL Integration](#graphql-integration)
    - [Member GraphQL Type](#member-graphql-type)
    - [Member Creation Input Type](#member-creation-input-type)
    - [Complex Object Resolvers](#complex-object-resolvers)
  - [Member Queries](#member-queries)
  - [Usage in the System](#usage-in-the-system)
  - [Database Implementation](#database-implementation)
  - [Security Considerations](#security-considerations)

# Member Model

Relevant source files

* [src/graphql/mutations/project\_mutations.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs)
* [src/graphql/queries/member\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs)
* [src/graphql/queries/project\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs)
* [src/models/member.rs](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs)

## Purpose and Scope

This document details the Member data model, which is the central entity in the Root system. The Member model represents individual club members with their personal and identification information. For information about attendance tracking, see [Attendance Model](/amfoss/root/3.2-attendance-model), and for member projects, see [Project Model](/amfoss/root/3.4-project-model).

## Model Overview

The Member model stores essential information about each club member, including identification details, contact information, and organizational metadata. It serves as the cornerstone of the Root system, with relationships to attendance records, projects, and activity streaks.

Sources: [src/models/member.rs13-28](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L13-L28)

## Field Definitions

The Member model contains the following fields:

| Field | Type | Description | Constraints |
| --- | --- | --- | --- |
| `member_id` | i32 | Unique identifier for the member | Primary Key, Auto-increment |
| `roll_no` | String | Academic roll number | Unique |
| `name` | String | Full name of the member |  |
| `email` | String | Email address | Unique |
| `sex` | Sex enum | Gender (M/F/Other) |  |
| `year` | i32 | Academic year |  |
| `hostel` | String | Hostel/accommodation information |  |
| `mac_address` | String | MAC address of member's device | Unique |
| `discord_id` | String | Discord identifier | Unique |
| `group_id` | i32 | Group/team identifier | Foreign Key |
| `created_at` | NaiveDateTime | Timestamp of record creation | Not exposed in GraphQL |

Sources: [src/models/member.rs15-28](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L15-L28)

## Sex Enumeration

The Member model uses a custom enumeration type for the `sex` field:

This enumeration is implemented as a PostgreSQL custom type named `sex_type` and is mapped to Rust using sqlx type mapping.

Sources: [src/models/member.rs5-11](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L5-L11)

## Related Models and Relationships

The Member model has relationships with several other models in the system:

These relationships are implemented in the GraphQL API through the ComplexObject trait for the Member struct, providing related data through resolver methods.

Sources: [src/graphql/queries/member\_queries.rs46-94](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L46-L94)

## GraphQL Integration

### Member GraphQL Type

The Member struct is exposed as a GraphQL type through the `SimpleObject` derive macro from async-graphql. It is also marked with the `complex` attribute to enable the implementation of complex object resolvers for related entities.

Sources: [src/models/member.rs13-14](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L13-L14)

### Member Creation Input Type

For creating new members, a dedicated input type is defined:

This input type is used in member creation mutations in the GraphQL API.

Sources: [src/models/member.rs30-41](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L30-L41)

### Complex Object Resolvers

The Member model implements several resolver methods to fetch related data:

1. **Attendance Records**: Fetches attendance records for the member
2. **Attendance Summary**: Retrieves monthly attendance summaries
3. **Streak Information**: Gets status update streak data
4. **Projects**: Retrieves projects associated with the member

These resolvers fetch related data from the database using the member's ID as a foreign key.

Sources: [src/graphql/queries/member\_queries.rs46-94](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L46-L94)

## Member Queries

The system provides GraphQL queries to retrieve member data with optional filtering:

The `members` query supports optional filtering by:

* `year`: Academic year
* `group_id`: Group/team identifier

Sources: [src/graphql/queries/member\_queries.rs15-44](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L15-L44)

## Usage in the System

The Member model serves as the foundation for several key system functions:

1. **Attendance Tracking**: Members have associated daily attendance records
2. **Attendance Summaries**: Monthly attendance statistics are computed for each member
3. **Status Update Streaks**: Activity streaks are tracked per member
4. **Project Management**: Projects are associated with members
5. **Group Organization**: Members are organized into groups

The Member model is accessed through GraphQL queries and mutations, allowing client applications to retrieve and modify member data with appropriate filters and relationships.

## Database Implementation

The Member model is mapped to a PostgreSQL database table named `Member` using SQLx for type-safe database access. It uses the `FromRow` trait to map database results directly to the Rust struct.

Sources: [src/models/member.rs13](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L13-L13)

## Security Considerations

The Member model contains several sensitive fields that should be protected:

1. **Personal Information**: Fields like name, email, and hostel should be handled according to privacy regulations
2. **Device Identifiers**: MAC addresses should be securely stored
3. **Communication IDs**: Discord IDs should be protected

The GraphQL API implementation handles permissions and access control to ensure appropriate data protection.