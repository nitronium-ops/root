#  Member Mutations

## Quick Navigation

- [overview](1-overview.md)
- [system-architecture](2-system-architecture.md)
  - [application-configuration](2.1-application-configuration.md)
- [database-models](3-database-models.md)
  - [member-model](3.1-member-model.md)
  - [attendance-model](3.2-attendance-model.md)
  - [streak-model](3.3-streak-model.md)
  - [project-model](3.4-project-model.md)
- [graphql-api](4-graphql-api.md)
  - [graphql-queries](4.1-graphql-queries.md)
    - [member-queries](4.1.1-member-queries.md)
    - [attendance-queries](4.1.2-attendance-queries.md)
    - [streak-queries](4.1.3-streak-queries.md)
    - [project-queries](4.1.4-project-queries.md)
  - [graphql-mutations](4.2-graphql-mutations.md)
    - [member-mutations](4.2.1-member-mutations.md)
    - [attendance-mutations](4.2.2-attendance-mutations.md)
    - [streak-mutations](4.2.3-streak-mutations.md)
    - [project-mutations](4.2.4-project-mutations.md)
- [background-tasks](5-background-tasks.md)
  - [daily-attendance-task](5.1-daily-attendance-task.md)
- [deployment-and-cicd](6-deployment-and-cicd.md)
  - [github-actions-workflows](6.1-github-actions-workflows.md)
  - [docker-deployment](6.2-docker-deployment.md)
- [security-features](7-security-features.md)
  - [hmac-authentication](7.1-hmac-authentication.md)

## Table of Contents

- [Member Mutations](#member-mutations)
  - [Purpose and Scope](#purpose-and-scope)
  - [Overview](#overview)
  - [Member Input Structure](#member-input-structure)
  - [Member Model](#member-model)
  - [Available Mutations](#available-mutations)
    - [Create Member](#create-member)
      - [Data Flow for Create Member](#data-flow-for-create-member)
  - [Implementation Pattern](#implementation-pattern)
  - [Related Components](#related-components)

# Member Mutations

Relevant source files

* [src/graphql/mutations/project\_mutations.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs)
* [src/graphql/queries/member\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs)
* [src/graphql/queries/project\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs)
* [src/models/member.rs](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs)

## Purpose and Scope

This document details the GraphQL mutations used for creating and modifying club member data in the Root system. Member Mutations provide write operations for managing the Member entity in the database, including creating new members and updating member information. For information about retrieving member data, see [Member Queries](/amfoss/root/4.1.1-member-queries).

## Overview

Member Mutations are part of the GraphQL API layer in the Root system. They handle write operations related to the `Member` entity, allowing client applications to create and manage member records in the PostgreSQL database.

Sources: System Architecture Overview, Related Components

## Member Input Structure

The `CreateMemberInput` struct defines the fields required to create a new member:

| Field | Type | Description |
| --- | --- | --- |
| roll\_no | String | Unique roll number for the member |
| name | String | Full name of the member |
| email | String | Email address (must be unique) |
| sex | Sex (Enum) | Gender (M, F, Other) |
| year | Integer | Year of study |
| hostel | String | Hostel information |
| mac\_address | String | MAC address (must be unique) |
| discord\_id | String | Discord identifier (must be unique) |
| group\_id | Integer | Group membership identifier |

Sources: [src/models/member.rs30-41](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L30-L41)

## Member Model

Member mutations operate on the `Member` model with the following structure:

| Field | Type | Description |
| --- | --- | --- |
| member\_id | i32 | Primary key, auto-generated |
| roll\_no | String | Unique roll number |
| name | String | Full name |
| email | String | Email address (unique) |
| sex | Sex (Enum) | Gender (M, F, Other) |
| year | i32 | Year of study |
| hostel | String | Hostel information |
| mac\_address | String | MAC address (unique) |
| discord\_id | String | Discord ID (unique) |
| group\_id | i32 | Group identifier |
| created\_at | NaiveDateTime | Record creation timestamp (not exposed in GraphQL) |

Sources: [src/models/member.rs13-28](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L13-L28)

## Available Mutations

### Create Member

Creates a new member record in the database using the fields provided in the input.

**Input:**

* `CreateMemberInput` object containing member details

**Returns:**

* The newly created `Member` object

#### Data Flow for Create Member

Sources: [src/models/member.rs30-41](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs#L30-L41) [src/graphql/mutations/project\_mutations.rs11-28](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs#L11-L28)

## Implementation Pattern

Member mutations follow a consistent implementation pattern similar to other mutations in the codebase. The typical implementation:

1. Defines a struct (e.g., `MemberMutations`) with default implementation
2. Implements the `Object` trait for this struct to expose GraphQL mutations
3. Uses the database pool from GraphQL context to execute SQL operations
4. Returns the appropriate data or errors

Example implementation pattern (based on similar mutations in the codebase):

Sources: [src/graphql/mutations/project\_mutations.rs8-28](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs#L8-L28)

## Related Components

Member mutations integrate with several other components:

* **Member Model**: Defined in [src/models/member.rs](https://github.com/amfoss/root/blob/2b58803d/src/models/member.rs)
* **Database Connection**: Uses a connection pool (`PgPool`) accessed through the GraphQL context
* **GraphQL API**: Part of the overall GraphQL API structure
* **Member Queries**: For retrieving member data after mutations ([Member Queries](/amfoss/root/4.1.1-member-queries))

These mutations handle data validation, database operations, and returning appropriate responses or errors to the client.

Sources: [src/graphql/queries/member\_queries.rs12-44](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L12-L44) [src/graphql/mutations/project\_mutations.rs11-28](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs#L11-L28)