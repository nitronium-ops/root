# GitHub Actions Workflows

## Quick Navigation

- [Overview](1-overview.md)
- [System Architecture](2-system-architecture.md)
  - [Application Configuration](2.1-application-configuration.md)
- [Database Models](3-database-models.md)
  - [Member Model](3.1-member-model.md)
  - [Attendance Model](3.2-attendance-model.md)
  - [Streak Model](3.3-streak-model.md)
  - [Project Model](3.4-project-model.md)
- [GraphQL API](4-graphql-api.md)
  - [GraphQL Queries](4.1-graphql-queries.md)
    - [Member Queries](4.1.1-member-queries.md)
    - [Attendance Queries](4.1.2-attendance-queries.md)
    - [Streak Queries](4.1.3-streak-queries.md)
    - [Project Queries](4.1.4-project-queries.md)
  - [GraphQL Mutations](4.2-graphql-mutations.md)
    - [Member Mutations](4.2.1-member-mutations.md)
    - [Attendance Mutations](4.2.2-attendance-mutations.md)
    - [Streak Mutations](4.2.3-streak-mutations.md)
    - [Project Mutations](4.2.4-project-mutations.md)
- [Background Tasks](5-background-tasks.md)
  - [Daily Attendance Task](5.1-daily-attendance-task.md)
- [Deployment and CI/CD](6-deployment-and-cicd.md)
  - [GitHub Actions Workflows](6.1-github-actions-workflows.md)
  - [Docker Deployment](6.2-docker-deployment.md)
- [Security Features](7-security-features.md)
  - [HMAC Authentication](7.1-hmac-authentication.md)

## Table of Contents

- [GitHub Actions Workflows](#github-actions-workflows)
  - [Purpose and Scope](#purpose-and-scope)
  - [Overview of CI/CD Pipeline](#overview-of-cicd-pipeline)
  - [Lint Workflow](#lint-workflow)
    - [Workflow Trigger](#workflow-trigger)
    - [Workflow Jobs](#workflow-jobs)
    - [Implementation Details](#implementation-details)
      - [Clippy Job](#clippy-job)
      - [Rustfmt Job](#rustfmt-job)
  - [Generate Release Workflow](#generate-release-workflow)
    - [Workflow Trigger](#workflow-trigger)
    - [Workflow Strategy](#workflow-strategy)
    - [Implementation Details](#implementation-details)
      - [Matrix Configuration](#matrix-configuration)
      - [Build and Release Process](#build-and-release-process)
  - [Dependabot Configuration](#dependabot-configuration)
    - [Configuration](#configuration)
    - [Implementation Details](#implementation-details)
  - [Integration with Development Workflow](#integration-with-development-workflow)
  - [Best Practices for Developers](#best-practices-for-developers)

# GitHub Actions Workflows

Relevant source files

* [.github/dependabot.yml](https://github.com/amfoss/root/blob/2b58803d/.github/dependabot.yml)
* [.github/workflows/generate-release.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml)
* [.github/workflows/lint.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml)

## Purpose and Scope

This document details the GitHub Actions workflows implemented in the Root repository. These workflows automate code quality checks, release generation, and dependency management. For information about Docker deployment, see [Docker Deployment](/amfoss/root/6.2-docker-deployment).

## Overview of CI/CD Pipeline

The Root project employs several automated workflows to ensure code quality and streamline the release process. These workflows integrate with GitHub's features to provide continuous integration, code quality assurance, and release automation.

Sources: [.github/workflows/lint.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml) [.github/workflows/generate-release.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml) [.github/dependabot.yml](https://github.com/amfoss/root/blob/2b58803d/.github/dependabot.yml)

## Lint Workflow

The lint workflow enforces code quality standards by running Rust's linting and formatting tools on all pull requests to the main and develop branches.

### Workflow Trigger

The lint workflow is triggered automatically when:

* A pull request is opened against the `main` branch
* A pull request is opened against the `develop` branch

### Workflow Jobs

The lint workflow consists of two parallel jobs:

1. **Clippy**: Runs Rust's linter to identify potential bugs, performance issues, and style concerns
2. **Rustfmt**: Ensures code formatting adheres to Rust's style guidelines

Sources: [.github/workflows/lint.yml1-39](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml#L1-L39)

### Implementation Details

#### Clippy Job

```
- Name: Clippy
- Runs on: ubuntu-latest
- Steps:
  1. Checkout repository using actions/checkout@v4
  2. Cache Rust dependencies using Swatinem/rust-cache@v2
  3. Install Clippy component
  4. Run Clippy with all features and treat warnings as errors

```

Sources: [.github/workflows/lint.yml8-23](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml#L8-L23)

#### Rustfmt Job

```
- Name: Format
- Runs on: ubuntu-latest
- Steps:
  1. Checkout repository using actions/checkout@v4
  2. Cache Rust dependencies using Swatinem/rust-cache@v2
  3. Install Rustfmt component
  4. Check code formatting with rustfmt

```

Sources: [.github/workflows/lint.yml25-39](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml#L25-L39)

## Generate Release Workflow

The Generate Release workflow automates building and publishing platform-specific binaries whenever a new version tag is pushed to the repository.

### Workflow Trigger

This workflow is triggered when:

* A tag matching the pattern `v*` (e.g., v1.0.0) is pushed to the repository

### Workflow Strategy

The workflow uses a matrix strategy to simultaneously build releases for multiple platforms:

* Linux (x86\_64-unknown-linux-gnu)
* Windows (x86\_64-pc-windows-msvc)
* macOS ARM64 (aarch64-apple-darwin)

Sources: [.github/workflows/generate-release.yml1-86](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml#L1-L86)

### Implementation Details

#### Matrix Configuration

The workflow defines a matrix with different configurations for each target platform:

| Target | OS | Extension | Archive Format |
| --- | --- | --- | --- |
| x86\_64-unknown-linux-gnu | ubuntu-latest | "" | .tar.gz |
| x86\_64-pc-windows-msvc | windows-latest | .exe | .zip |
| aarch64-apple-darwin | macos-latest | "" | .tar.gz |

Sources: [.github/workflows/generate-release.yml9-29](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml#L9-L29)

#### Build and Release Process

For each platform in the matrix, the workflow:

1. Checks out the repository
2. Extracts the tag name (e.g., v1.0.0) to use as the release version
3. Installs the appropriate Rust toolchain for the target platform
4. Builds the binary in release mode for the target platform
5. Determines the binary name from cargo metadata
6. Strips the binary on Linux/macOS to reduce size
7. Packages the binary (tar.gz for Linux/macOS, zip for Windows)
8. Uploads the package to GitHub Releases
9. Generates release notes automatically

Sources: [.github/workflows/generate-release.yml31-85](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml#L31-L85)

## Dependabot Configuration

Root uses GitHub's Dependabot to automate dependency updates, ensuring the project stays up-to-date with the latest package versions and security patches.

### Configuration

Sources: [.github/dependabot.yml1-7](https://github.com/amfoss/root/blob/2b58803d/.github/dependabot.yml#L1-L7)

### Implementation Details

Dependabot is configured to:

* Monitor the `cargo` package ecosystem (Rust dependencies)
* Check the root directory of the repository
* Run on a weekly schedule
* Create individual pull requests for each dependency that needs updating

Sources: [.github/dependabot.yml1-7](https://github.com/amfoss/root/blob/2b58803d/.github/dependabot.yml#L1-L7)

## Integration with Development Workflow

GitHub Actions workflows are seamlessly integrated into the overall development process, providing automated guardrails for code quality and release management.

Sources: [.github/workflows/lint.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml) [.github/workflows/generate-release.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml) [.github/dependabot.yml](https://github.com/amfoss/root/blob/2b58803d/.github/dependabot.yml)

## Best Practices for Developers

When working with the Root repository, keep these GitHub Actions workflow-related tips in mind:

1. **Pull Requests**: All PRs to main and develop branches will automatically be checked by the lint workflow

   * Ensure your code passes `cargo clippy` and `cargo fmt` locally before submitting
   * Fix any linting issues before requesting review
2. **Releases**: To create a new release:

   * Tag the commit with a version number prefixed with 'v' (e.g., `v1.0.0`)
   * Push the tag to the repository
   * The Generate Release workflow will automatically build and publish binaries
3. **Dependencies**:

   * Dependabot will automatically create PRs for dependency updates
   * Review and test these PRs before merging
   * The lint workflow will run automatically on Dependabot PRs

Sources: [.github/workflows/lint.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/lint.yml) [.github/workflows/generate-release.yml](https://github.com/amfoss/root/blob/2b58803d/.github/workflows/generate-release.yml) [.github/dependabot.yml](https://github.com/amfoss/root/blob/2b58803d/.github/dependabot.yml)