# Project Model

## Quick Navigation

- [Overview](1-overview.md)
- [System Architecture](2-system-architecture.md)
  - [Application Configuration](2.1-application-configuration.md)
- [Database Models](3-database-models.md)
  - [Member Model](3.1-member-model.md)
  - [Attendance Model](3.2-attendance-model.md)
  - [Streak Model](3.3-streak-model.md)
  - [Project Model](3.4-project-model.md)
- [GraphQL API](4-graphql-api.md)
  - [GraphQL Queries](4.1-graphql-queries.md)
    - [Member Queries](4.1.1-member-queries.md)
    - [Attendance Queries](4.1.2-attendance-queries.md)
    - [Streak Queries](4.1.3-streak-queries.md)
    - [Project Queries](4.1.4-project-queries.md)
  - [GraphQL Mutations](4.2-graphql-mutations.md)
    - [Member Mutations](4.2.1-member-mutations.md)
    - [Attendance Mutations](4.2.2-attendance-mutations.md)
    - [Streak Mutations](4.2.3-streak-mutations.md)
    - [Project Mutations](4.2.4-project-mutations.md)
- [Background Tasks](5-background-tasks.md)
  - [Daily Attendance Task](5.1-daily-attendance-task.md)
- [Deployment and CI/CD](6-deployment-and-cicd.md)
  - [GitHub Actions Workflows](6.1-github-actions-workflows.md)
  - [Docker Deployment](6.2-docker-deployment.md)
- [Security Features](7-security-features.md)
  - [HMAC Authentication](7.1-hmac-authentication.md)

## Table of Contents

- [Project Model](#project-model)
  - [1. Project Model Structure](#1-project-model-structure)
  - [2. Database Schema](#2-database-schema)
  - [3. Model Implementation](#3-model-implementation)
  - [4. GraphQL API for Projects](#4-graphql-api-for-projects)
    - [4.1 Queries](#41-queries)
    - [4.2 Mutations](#42-mutations)
  - [5. Integration with Other Models](#5-integration-with-other-models)
  - [6. Implementation Notes](#6-implementation-notes)

# Project Model

Relevant source files

* [migrations/20250124095543\_create\_project\_table.sql](https://github.com/amfoss/root/blob/2b58803d/migrations/20250124095543_create_project_table.sql)
* [src/graphql/mutations/mod.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/mod.rs)
* [src/graphql/mutations/project\_mutations.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs)
* [src/graphql/queries/member\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs)
* [src/graphql/queries/mod.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/mod.rs)
* [src/graphql/queries/project\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs)
* [src/models/project.rs](https://github.com/amfoss/root/blob/2b58803d/src/models/project.rs)

The Project Model represents the projects that members of the organization work on. This page documents the structure, database schema, relationships, and available GraphQL operations for the Project model in the Root system. For information about members, see [Member Model](/amfoss/root/3.1-member-model).

## 1. Project Model Structure

The Project model is a simple data structure that associates a project title with a member. Each project belongs to exactly one member, while a member can have multiple projects associated with them.

Sources: [src/models/project.rs1-15](https://github.com/amfoss/root/blob/2b58803d/src/models/project.rs#L1-L15)

## 2. Database Schema

The Project model is stored in the database using the following schema:

The Project table has a foreign key constraint that ensures data integrity by referencing the Member table. When a member is deleted, all of their associated projects are automatically deleted due to the CASCADE delete rule.

Sources: [migrations/20250124095543\_create\_project\_table.sql1-6](https://github.com/amfoss/root/blob/2b58803d/migrations/20250124095543_create_project_table.sql#L1-L6)

## 3. Model Implementation

The Project model is implemented as a Rust struct with the following fields:

| Field | Type | Description |
| --- | --- | --- |
| `project_id` | `i32` | The unique identifier for the project (primary key) |
| `member_id` | `i32` | Reference to the member who owns the project (foreign key) |
| `title` | `Option<String>` | The title of the project, which is optional |

The model implements the `FromRow` trait from sqlx for database deserialization and the `SimpleObject` trait from async-graphql for GraphQL schema generation.

For creating new projects, the system uses the `SetProjectInput` struct:

| Field | Type | Description |
| --- | --- | --- |
| `member_id` | `i32` | ID of the member who owns the project |
| `title` | `String` | The title of the project |

Sources: [src/models/project.rs1-15](https://github.com/amfoss/root/blob/2b58803d/src/models/project.rs#L1-L15)

## 4. GraphQL API for Projects

### 4.1 Queries

The Project model can be queried through the GraphQL API in two ways:

1. Directly via the `projects` query that returns all projects in the system:

2. Indirectly via the Member object, which can include its associated projects:

Sources:

* [src/graphql/queries/project\_queries.rs1-22](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs#L1-L22)
* [src/graphql/queries/member\_queries.rs85-93](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L85-L93)

### 4.2 Mutations

The API provides a mutation to create new projects:

| Mutation | Input | Return | Description |
| --- | --- | --- | --- |
| `setProject` | `SetProjectInput` | `Project` | Creates a new project for a member |

Sources: [src/graphql/mutations/project\_mutations.rs1-29](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs#L1-L29)

## 5. Integration with Other Models

The Project model is primarily integrated with the Member model in a one-to-many relationship. A member can have multiple projects, but each project belongs to exactly one member.

The GraphQL API supports this relationship by allowing:

1. Querying all projects in the system
2. Querying projects associated with a specific member
3. Creating new projects for a member

Sources:

* [src/graphql/queries/member\_queries.rs85-93](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L85-L93)
* [src/models/project.rs1-15](https://github.com/amfoss/root/blob/2b58803d/src/models/project.rs#L1-L15)
* [migrations/20250124095543\_create\_project\_table.sql1-6](https://github.com/amfoss/root/blob/2b58803d/migrations/20250124095543_create_project_table.sql#L1-L6)

## 6. Implementation Notes

The implementation of the Project model is straightforward, with basic CRUD operations supported through the GraphQL API. The database operations use sqlx for type-safe SQL queries:

* Project queries use a simple `SELECT * FROM Project` for retrieving all projects
* Member-specific project queries use `SELECT project_id, title FROM Project WHERE member_id = $1`
* Project creation uses `INSERT INTO Project (member_id, project_title) VALUES ($1, $2) RETURNING *`

Note that the SQL query in the `setProject` mutation uses `project_title` as the column name, while the schema defines it as `title`. This appears to be an inconsistency in the codebase that should be addressed.

Sources:

* [src/graphql/queries/project\_queries.rs12-20](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs#L12-L20)
* [src/graphql/queries/member\_queries.rs85-93](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L85-L93)
* [src/graphql/mutations/project\_mutations.rs19-25](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs#L19-L25)