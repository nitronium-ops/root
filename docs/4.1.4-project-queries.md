#  Project Queries

## Quick Navigation

- [overview](1-overview.md)
- [system-architecture](2-system-architecture.md)
  - [application-configuration](2.1-application-configuration.md)
- [database-models](3-database-models.md)
  - [member-model](3.1-member-model.md)
  - [attendance-model](3.2-attendance-model.md)
  - [streak-model](3.3-streak-model.md)
  - [project-model](3.4-project-model.md)
- [graphql-api](4-graphql-api.md)
  - [graphql-queries](4.1-graphql-queries.md)
    - [member-queries](4.1.1-member-queries.md)
    - [attendance-queries](4.1.2-attendance-queries.md)
    - [streak-queries](4.1.3-streak-queries.md)
    - [project-queries](4.1.4-project-queries.md)
  - [graphql-mutations](4.2-graphql-mutations.md)
    - [member-mutations](4.2.1-member-mutations.md)
    - [attendance-mutations](4.2.2-attendance-mutations.md)
    - [streak-mutations](4.2.3-streak-mutations.md)
    - [project-mutations](4.2.4-project-mutations.md)
- [background-tasks](5-background-tasks.md)
  - [daily-attendance-task](5.1-daily-attendance-task.md)
- [deployment-and-cicd](6-deployment-and-cicd.md)
  - [github-actions-workflows](6.1-github-actions-workflows.md)
  - [docker-deployment](6.2-docker-deployment.md)
- [security-features](7-security-features.md)
  - [hmac-authentication](7.1-hmac-authentication.md)

## Table of Contents

- [Project Queries](#project-queries)
  - [Introduction](#introduction)
  - [Project Data Model](#project-data-model)
  - [Available Project Queries](#available-project-queries)
    - [Primary Query: projects](#primary-query-projects)
    - [Member-Related Project Query](#member-related-project-query)
  - [Implementation Details](#implementation-details)
    - [ProjectQueries Implementation](#projectqueries-implementation)
    - [Member-Project Relationship Query](#member-project-relationship-query)
  - [Query Execution Flow](#query-execution-flow)
  - [Integration with the GraphQL Schema](#integration-with-the-graphql-schema)
  - [Conclusion](#conclusion)

# Project Queries

Relevant source files

* [migrations/20250124095543\_create\_project\_table.sql](https://github.com/amfoss/root/blob/2b58803d/migrations/20250124095543_create_project_table.sql)
* [src/graphql/mutations/mod.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/mod.rs)
* [src/graphql/mutations/project\_mutations.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs)
* [src/graphql/queries/member\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs)
* [src/graphql/queries/mod.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/mod.rs)
* [src/graphql/queries/project\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs)
* [src/models/project.rs](https://github.com/amfoss/root/blob/2b58803d/src/models/project.rs)

## Introduction

This document provides technical details about the Project Queries component in the Root system. Project Queries are responsible for retrieving project data via GraphQL API. For information about modifying project data, see [Project Mutations](/amfoss/root/4.2.4-project-mutations).

Project Queries allow clients to fetch information about projects that club members are working on. These queries are part of the GraphQL API layer and interact with the PostgreSQL database to retrieve project records.

Sources: [src/graphql/queries/project\_queries.rs1-22](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs#L1-L22)

## Project Data Model

Before diving into the queries, it's important to understand the Project data model that these queries operate on.

The Project model consists of:

| Field | Type | Description |
| --- | --- | --- |
| project\_id | i32 | Primary key identifier for the project |
| member\_id | i32 | Foreign key reference to a Member |
| title | Option<String> | Optional title of the project |

The database schema for the Project table includes a foreign key constraint that links projects to members, ensuring referential integrity.

Sources: [src/models/project.rs4-9](https://github.com/amfoss/root/blob/2b58803d/src/models/project.rs#L4-L9) [migrations/20250124095543\_create\_project\_table.sql1-6](https://github.com/amfoss/root/blob/2b58803d/migrations/20250124095543_create_project_table.sql#L1-L6)

## Available Project Queries

### Primary Query: projects

The `projects` query retrieves all projects in the system. It returns an array of Project objects containing their IDs, associated member IDs, and titles.

Example GraphQL query:

Sources: [src/graphql/queries/project\_queries.rs10-21](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs#L10-L21)

### Member-Related Project Query

In addition to the standalone `projects` query, projects can also be retrieved in relation to a specific member through the `Member` complex object implementation. This allows clients to fetch a member's projects as part of a member query.

Example GraphQL query for a member's projects:

Sources: [src/graphql/queries/member\_queries.rs85-93](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L85-L93)

## Implementation Details

### ProjectQueries Implementation

The `ProjectQueries` struct implements the GraphQL Object trait, providing the `projects` query method. This method:

1. Retrieves the database connection pool from the GraphQL context
2. Executes a SQL query to fetch all projects from the database
3. Returns the projects as a vector of Project objects or an error

The implementation is straightforward and doesn't include filtering options, as it's designed to return all projects in the system.

Sources: [src/graphql/queries/project\_queries.rs7-21](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs#L7-L21)

### Member-Project Relationship Query

The Member complex object implementation includes a `projects` resolver that:

1. Takes a Member object and the GraphQL context
2. Retrieves the database connection pool from the context
3. Executes a SQL query to fetch projects specific to the member using their `member_id`
4. Returns the member's projects as a vector or an empty vector if none are found

This implementation allows for nested GraphQL queries where clients can fetch members and their associated projects in a single request.

Sources: [src/graphql/queries/member\_queries.rs85-93](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L85-L93)

## Query Execution Flow

The following diagram illustrates the execution flow when a client requests project data:

Sources: [src/graphql/queries/project\_queries.rs10-21](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs#L10-L21) [src/graphql/queries/member\_queries.rs85-93](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L85-L93)

## Integration with the GraphQL Schema

The `ProjectQueries` struct is imported and integrated into the main GraphQL schema through the module system. The query resolver is registered in the schema builder, making the `projects` query available in the GraphQL API.

Sources: [src/graphql/queries/mod.rs3-9](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/mod.rs#L3-L9)

## Conclusion

Project Queries provide a simple but effective way to retrieve project data from the Root system. The API supports both standalone queries for all projects and member-specific project queries through the member object relationship. This design allows clients to efficiently fetch project data according to their specific requirements.

For modifying project data, refer to the [Project Mutations](/amfoss/root/4.2.4-project-mutations) documentation.